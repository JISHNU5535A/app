{"ts":1370580360318,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"/**\n * Copyright 2012 Google Inc. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nvar readline = require('readline');\n\nvar googleapis = require('googleapis');\nvar OAuth2Client = googleapis.OAuth2Client;\n\n// Client ID and client secret are available at\n// https://code.google.com/apis/console\nvar CLIENT_ID = '998322373435.apps.googleusercontent.com';\nvar CLIENT_SECRET = 'U8QgUx2ygHzI-n5txUPMgcYV';\nvar REDIRECT_URL = 'http://localhost/oauth2callback';\n\nvar rl = readline.createInterface({\n  input: process.stdin,\n  output: process.stdout\n});\n\nfunction getAccessToken(oauth2Client, callback) {\n  // generate consent page url\n  var url = oauth2Client.generateAuthUrl({\n    access_type: 'offline',\n    scope: 'https://www.googleapis.com/auth/plus.me'\n  });\n\n  console.log('Visit the url: ', url);\n  rl.question('Enter the code here:', function(code) {\n\n    // request access token\n    oauth2Client.getToken(code, function(err, tokens) {\n      // set tokens to the client\n      // TODO: tokens should be set by OAuth2 client.\n      oauth2Client.credentials = tokens;\n      callback && callback();\n    });\n  });\n}\n\nfunction getUserProfile(client, authClient, userId, callback) {\n  client\n    .plus.people.get({ userId: userId })\n    .withAuthClient(authClient)\n    .execute(callback);\n}\n\nfunction printUserProfile(err, profile) {\n  if (err) {\n    console.log('An error occurred');\n  } else {\n    console.log(profile.displayName, ':', profile.tagline);\n    console.log(profile)\n  }\n}\n\n// load google plus v1 API resources and methods\ngoogleapis\n  .discover('plus', 'v1')\n  .execute(function(err, client) {\n\n  var oauth2Client =\n    new OAuth2Client(CLIENT_ID, CLIENT_SECRET, REDIRECT_URL);\n\n  // retrieve an access token\n  getAccessToken(oauth2Client, function() {\n    // retrieve user profile\n    getUserProfile(\n      client, oauth2Client, 'me', printUserProfile);\n  });\n\n});\n"]],"start1":0,"start2":0,"length1":0,"length2":2410}]],"length":2410}
